
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Multi-model evaluation &#8212; TLViz 0.0.3 documentation</title> 
<link rel="stylesheet" href="../_static/tensorly_style.css">
<link rel="apple-touch-icon" sizes="180x180" href="../_static/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../_static/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../_static/favicon/favicon-16x16.png">
<link rel="manifest" href="../_static/favicon/site.webmanifest">
<link rel="mask-icon" href="../_static/favicon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="../_static/favicon/favicon.ico">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tensorly_style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />

  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
 <script src="../_static/navbar_burger.js"></script>
 <script defer src="https://use.fontawesome.com/releases/v5.14.0/js/all.js"></script>
 
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Outlier detection" href="outliers.html" />
    <link rel="prev" title="Model evaluation" href="model_evaluation.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  </head>
<body  class="has-navbar-fixed-top">

  <header>
    <navbar>
      <nav class="navbar top-navbar is-fixed-top has-shadow is-flex-wrap-wrap" role="navigation" aria-label="main top navigation">
        <div class="navbar-brand">
        <!-- Always displayed, last item has to be navbar-burger -->

          <a class="navbar-item" href="../index.html">
            <img src="../_static/tlviz_logo.svg" height="28">
          </a>

          <!-- <a class="navbar-item is-hidden-desktop" href="../index.html">
            <span class="icon"><i class="fa fa-home" aria-hidden="true"></i></span>
          </a> -->
          <a class="navbar-item is-hidden-desktop" href="https://github.com/marieroald/tlviz" target="_blank">
              <span class="icon"><i class="fab fa-github"></i></span>
          </a>

          <a role="button" class="navbar-burger" data-target="top-nav-menu" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>

        </div>
        
        <div class="navbar-menu" id="top-nav-menu">
        <!-- only on larger displays (> 1024px) -->

          <div class="navbar-start">
          <!-- RIGHT -->
            <a class="navbar-item" href="../about_tensors.html">
              Introduction
            </a>
            <a class="navbar-item" href="../installation.html">
              Installation
            </a>
            <a class="navbar-item" href="../auto_examples/index.html">
              Examples
            </a>
            <a class="navbar-item" href="../api.html">
              API
            </a>
            <a class="navbar-item" href="https://tensorly.org" target="_blank">
              TensorLy
            </a>

          </div>
        
          <div class="navbar-end">
            <div class="navbar-item">
            <!-- LEFT -->

            <!-- <a class="navbar-item is-hidden-touch" href="../index.html">
              <span class="icon-text">
                <span class="icon">
                  <i class="fa fa-home"></i>
                </span>
                <span>Home</span>
              </span>
              <span class="icon"><i class="fa fa-home" aria-hidden="true"></i></span>
            </a> -->
            <a class="button is-hidden-touch is-dark" href="https://github.com/marieroald/tlviz" target="_blank">
              <span class="icon-text">
                <span class="icon is-large">
                  <i class="fab fa-github"></i>
                </span>
                <span>Github</span>
              </span>
                <!-- <span class="icon"><i class="fab fa-github"></i></span> -->
            </a>

            </div> <!-- navbar item -->
          </div> <!-- navbar end -->
        </div> <!-- only large items -->

      </nav>
      
    </navbar>
  </header>

  <div id="column-container">
  <div class="columns is-mobile is-centered">
	
      <div class="column is-10-mobile is-one-third-tablet is-3-desktop is-hidden-mobile" id="sidebar">
    <!-- Side menu  -->
    <aside class="sticky-nav sidebar-menu">
<div class="sidebar-search">
  <form class="field" id="searchbox" role="search" action="../search.html" method="get">
    <!-- <label class="label" id="searchlabel">Quick search</label> -->
    <div class="field has-addons">
      <div class="control is-expanded">
        <input class="input" type="text" placeholder="Search in TLViz" name="q" aria-labelledby="searchlabel">
      </div>
      <div class="control">
        <input class="button is-info" type="submit" value="Go" />
      </div>
    </div>
  </form>
  <script>$('#searchbox').show(0);</script>
  <script>
  $(document).ready(function() {
    Document.highlightSearchWords = function() {
      var params = $.getQueryParameters();
      var terms = (params.highlight) ? params.highlight[0].split(/\s+/) : [];
      if (terms.length) {
        var body = $('div.body');
        if (!body.length) {
          body = $('body');
        }
        window.setTimeout(function() {
          $.each(terms, function() {
            body.highlightText(this.toLowerCase(), 'highlighted');
          });
        }, 10);
        $('<p class="highlight-link"><a href="javascript:Documentation.' +
          'hideSearchWords()">' + _('Hide All')
          + '<span class="tag is-delete"></span>'
          + '</a></p>')
            .appendTo($('#searchbox'));
      }
    };
  });
  </script>
</div>
      
      <div class="sidebar-menu-toc">
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about_tensors.html">What are tensors and tensor decompositions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Gallery of examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="postprocessing.html">Post-processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="factor_tools.html">Factor tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_evaluation.html">Model evaluation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Multi-model evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="outliers.html">Outlier detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualisation.html">Visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">Example datasets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tensorly_backends.html">Working with TensorLy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contribution guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>
 
      </div>
    </aside>
  </div>
  

    <div class="column main-column">

      <!-- Main content  -->
      <section class="main-section">

        <!-- Toggle menu button -->
		
        <div class="side-menu-toggle">
          <button class="button" id="toggle-sidebar" onclick="toggle_sidebar()">
            <span class="icon"><i class="fa fa-bars" aria-hidden="true"></i></span>
            <span>menu</span> 
          </button>
        </div>
        

        <div class="content main-content">
          
  <section id="module-tlviz.multimodel_evaluation">
<span id="multi-model-evaluation"></span><h1>Multi-model evaluation<a class="headerlink" href="#module-tlviz.multimodel_evaluation" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="tlviz.multimodel_evaluation.get_model_with_lowest_error">
<span class="sig-prename descclassname"><span class="pre">tlviz.multimodel_evaluation.</span></span><span class="sig-name descname"><span class="pre">get_model_with_lowest_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp_tensors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tlviz/multimodel_evaluation.html#get_model_with_lowest_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tlviz.multimodel_evaluation.get_model_with_lowest_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute reconstruction error for all cp_tensors and return model with lowest error.</p>
<p>This is useful to select the best initialisation if several random
initialisations are used to fit the model. By default, the relative SSE
is used, but another error function can be used too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cp_tensors</strong><span class="classifier">list of CPTensors</span></dt><dd><p>List of all CP tensors to compare</p>
</dd>
<dt><strong>dataset</strong><span class="classifier">ndarray</span></dt><dd><p>Dataset modelled by the CP tensors</p>
</dd>
<dt><strong>error_function</strong><span class="classifier">Callable (optional)</span></dt><dd><p>Callable with the signature <code class="docutils literal notranslate"><span class="pre">error_function(cp_tensor,</span> <span class="pre">dataset)</span></code>,
that should return a measure of the modelling error (e.g. SSE). Default
is relative SSE.</p>
</dd>
<dt><strong>return_index</strong><span class="classifier">bool (optional, default=False)</span></dt><dd><p>If True, then the index of the CP tensor with the lowest error is returned</p>
</dd>
<dt><strong>return_errors</strong><span class="classifier">bool (optional, defult=False)</span></dt><dd><p>if True, then a list of errors for each CP tensor is returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>CPTensor</dt><dd><p>The CP tensor with the lowest error</p>
</dd>
<dt>int</dt><dd><p>The index of the selected CP tensor in <code class="docutils literal notranslate"><span class="pre">cp_tensors</span></code>. Only returned
if <code class="docutils literal notranslate"><span class="pre">return_index=True</span></code>.</p>
</dd>
<dt>list</dt><dd><p>List of the error values for all CP tensors in <code class="docutils literal notranslate"><span class="pre">cp_tensor</span></code> (in the same
order as <code class="docutils literal notranslate"><span class="pre">cp_tensors</span></code>). only returned if <code class="docutils literal notranslate"><span class="pre">return_errors=True</span></code></p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Here, we illustrate how <code class="docutils literal notranslate"><span class="pre">get_model_with_lowest_error</span></code> can be used to get the selected model from a collection
of model candidates, and how we can also get the errors for all model candidates and the index of the selected
initialisation.</p>
<p>We start by importing the relevant functionality</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tlviz.multimodel_evaluation</span> <span class="kn">import</span> <span class="n">sort_models_by_error</span><span class="p">,</span> <span class="n">get_model_with_lowest_error</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tlviz.model_evaluation</span> <span class="kn">import</span> <span class="n">relative_sse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tlviz.data</span> <span class="kn">import</span> <span class="n">simulated_random_cp_tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tlviz.factor_tools</span> <span class="kn">import</span> <span class="n">check_cp_tensor_equal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensorly.decomposition</span> <span class="kn">import</span> <span class="n">parafac</span>
</pre></div>
</div>
<p>Then, we create a simulated dataset and fit five model candidates using different random initialisations.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cp_tensor</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">simulated_random_cp_tensor</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_candidates</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">parafac</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s2">&quot;random&quot;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">... </span><span class="p">]</span>
</pre></div>
</div>
<p>Once we have the model candidates, we use <code class="docutils literal notranslate"><span class="pre">get_model_with_lowest_error</span></code>. By default this function will only
return the selected model, but in this case, we ask it to return the index of the selected model and the errors
of all model candidates.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">get_model_with_lowest_error</span><span class="p">(</span><span class="n">model_candidates</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2"> has lowest error&quot;</span><span class="p">)</span>
<span class="go">Model 3 has lowest error</span>
</pre></div>
</div>
<p>We can check that the selected model is the model with the init we got</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">check_cp_tensor_equal</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model_candidates</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>And that it is the model that has the lowest error</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">errors</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">==</span> <span class="nb">min</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>And finally that this error is equal to the relative SSE</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">errors</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">==</span> <span class="n">relative_sse</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tlviz.multimodel_evaluation.similarity_evaluation">
<span class="sig-prename descclassname"><span class="pre">tlviz.multimodel_evaluation.</span></span><span class="sig-name descname"><span class="pre">similarity_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comparison_cp_tensors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tlviz/multimodel_evaluation.html#similarity_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tlviz.multimodel_evaluation.similarity_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute similarities between <code class="docutils literal notranslate"><span class="pre">cp_tensor</span></code> and all <code class="docutils literal notranslate"><span class="pre">comparison_cp_tensors</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cp_tensor</strong><span class="classifier">CPTensor or tuple</span></dt><dd><p>TensorLy-style CPTensor object or tuple with weights as first
argument and a tuple of components as second argument</p>
</dd>
<dt><strong>comparison_cp_tensors</strong><span class="classifier">List[CPTensor or tuple]</span></dt><dd><p>List of TensorLy-style CPTensors to compare with</p>
</dd>
<dt><strong>similarity_metric</strong><span class="classifier">Callable[CPTensor, CPTensor, **kwargs] -&gt; float</span></dt><dd><p>Function that takes two CPTensors as input and returns their similarity</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Extra keyword-arguments passed to <code class="docutils literal notranslate"><span class="pre">similarity_metric</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>similarity</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>In this example, we will fit several PARAFAC models to a simulated dataset and use <code class="docutils literal notranslate"><span class="pre">similarity_evaluation</span></code> to
compute the similarities between the different fitted models and the model that obtained the lowest error.</p>
<p>We start by importing the relevant functionality</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tlviz.multimodel_evaluation</span> <span class="kn">import</span> <span class="n">sort_models_by_error</span><span class="p">,</span> <span class="n">similarity_evaluation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tlviz.data</span> <span class="kn">import</span> <span class="n">simulated_random_cp_tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensorly.decomposition</span> <span class="kn">import</span> <span class="n">parafac</span>
</pre></div>
</div>
<p>Then, we create a random simulated dataset and fit five parafac models to it.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cp_tensor</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">simulated_random_cp_tensor</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_candidates</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">parafac</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s2">&quot;random&quot;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">... </span><span class="p">]</span>
</pre></div>
</div>
<p>Finally, we sort the models by their errors and compute the similarity between each model
and the model that obtained the lowest error.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sorted_model_candidates</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">sort_models_by_error</span><span class="p">(</span><span class="n">model_candidates</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">similarities</span> <span class="o">=</span> <span class="n">similarity_evaluation</span><span class="p">(</span><span class="n">sorted_model_candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sorted_model_candidates</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">similarities</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Similarity between the model with the lowest loss and the model with the </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="si">}</span><span class="s2">. lowest loss: </span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">.2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Similarity between the model with the lowest loss and the model with the 2. lowest loss: 0.99</span>
<span class="go">Similarity between the model with the lowest loss and the model with the 3. lowest loss: 0.98</span>
<span class="go">Similarity between the model with the lowest loss and the model with the 4. lowest loss: 0.68</span>
<span class="go">Similarity between the model with the lowest loss and the model with the 5. lowest loss: 0.42</span>
</pre></div>
</div>
<p>We see that the three models with the lowest error were very similar, which indicates that the model is stable.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tlviz.multimodel_evaluation.sort_models_by_error">
<span class="sig-prename descclassname"><span class="pre">tlviz.multimodel_evaluation.</span></span><span class="sig-name descname"><span class="pre">sort_models_by_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp_tensors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tlviz/multimodel_evaluation.html#sort_models_by_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tlviz.multimodel_evaluation.sort_models_by_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort the <code class="docutils literal notranslate"><span class="pre">cp_tensors</span></code> by their error so the model with the lowest error is first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cp_tensors</strong><span class="classifier">list of CPTensors</span></dt><dd><p>List of all CP tensors</p>
</dd>
<dt><strong>dataset</strong><span class="classifier">ndarray</span></dt><dd><p>Dataset modelled by the CP tensors</p>
</dd>
<dt><strong>error_function</strong><span class="classifier">Callable (optional)</span></dt><dd><p>Callable with the signature <code class="docutils literal notranslate"><span class="pre">error_function(cp_tensor,</span> <span class="pre">dataset)</span></code>,
that should return a measure of the modelling error (e.g. SSE).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>list of CPTensors</dt><dd><p>List of all CP tensors sorted so the CP tensor with the lowest error
is first and highest error is last.</p>
</dd>
<dt>list of floats</dt><dd><p>List of error computed for each CP tensor (in sorted order)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Here, we see how <code class="docutils literal notranslate"><span class="pre">sort_models_by_error</span></code> can be useful to get a collection of model candidates in a logical order.</p>
<p>We start by importing the relevant functionality.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tlviz.multimodel_evaluation</span> <span class="kn">import</span> <span class="n">sort_models_by_error</span><span class="p">,</span> <span class="n">get_model_with_lowest_error</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tlviz.data</span> <span class="kn">import</span> <span class="n">simulated_random_cp_tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensorly.decomposition</span> <span class="kn">import</span> <span class="n">parafac</span>
</pre></div>
</div>
<p>Then, we simulate a random dataset and fit five model candidates to it.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cp_tensor</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">simulated_random_cp_tensor</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_candidates</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">parafac</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s2">&quot;random&quot;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">... </span><span class="p">]</span>
</pre></div>
</div>
<p>Next, we sort the models by the error.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sorted_model_candidates</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">sort_models_by_error</span><span class="p">(</span><span class="n">model_candidates</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, the first element in sorted_model_candidates should be equal to the model with the lowest error.
Let’s double check by getting the model with the lowest error, and see which index it has.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lowest_error_model</span> <span class="o">=</span> <span class="n">get_model_with_lowest_error</span><span class="p">(</span><span class="n">model_candidates</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sorted_model_candidates</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">lowest_error_model</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Next, we can check if the errors are sorted</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">errors</span> <span class="o">==</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</section>


        </div>

		
        <nav class="pagination" role="navigation" aria-label="pagination">
    
    <a class="button is-medium pagination-previous" href="model_evaluation.html" title="previous page" accesskey="p">
        <span class="icon">
            <i class="fa fa-arrow-circle-left"></i>
        </span>
        <span>Model evaluation</span>
    </a>
    
    
    <a class="button is-medium pagination-next" href="outliers.html" title="next page" accesskey="n">
        <span>Outlier detection </span>
        <span class="icon">
            <i class="fa fa-arrow-circle-right"></i>
        </span>
    </a>
    
</nav>

        

      </section>

        <footer class="footer">
    <div class="content has-text-centered">
        <div class="block">
          &copy; Copyright 2021, Marie Roald &amp; Yngve Mardal Moe.<br/>
        </div>
      <div class="block">
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> and the <a href="tensorly.org"><strong>TensorLy</strong></a> theme by <a href="jeankossaifi.com">Jean Kossaifi</a>.
      </div>
    </div>
  </footer>

    </div>

	
    

    

  </div>
  </div>

  <!-- Include here scripts that need to be added after the page is loaded -->
  <script>
    function toggle_sidebar() {
        var element = document.getElementById("sidebar");
        var container = document.getElementById("column-container");
        var localtoccolumn = document.getElementById("localtoc-column");
        element.classList.toggle("hide-tablet");
        element.classList.toggle("is-hidden-mobile");
        container.classList.toggle("sidemenu-hidden");
        localtoccolumn.classList.toggle("is-one-fifth-widescreen");
        localtoccolumn.classList.toggle("is-2-desktop");
        localtoccolumn.classList.toggle("is-3-desktop");
    }
  </script> 



  </body>
</html>